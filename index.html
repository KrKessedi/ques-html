<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Category Page</title>
		<link rel="stylesheet" href="./css/index.css" />
		<link rel="stylesheet" href="./css/categories.css" />
		<link rel="stylesheet" href="./css/layout/header_layout.css" />
		<link rel="stylesheet" href="./css/layout/footer_layout.css" />
	</head>
	<body>
		<div id="root"></div>

		<!-- NavBar -->
		<section class="navbar">
			<div class="container">
				<ul class="nav-list">
					<li class="nav-item">
						<a href="/a" class="nav-link">НОВИНКИ</a>
					</li>
					<li class="nav-item">
						<a href="/categories" class="nav-link">КАТЕГОРИИ</a>
					</li>
					<li class="nav-item">
						<a href="/catalog" class="nav-link">КАТАЛОГ</a>
					</li>
					<li class="nav-item">
						<a href="/about" class="nav-link">О МАГАЗИНЕ</a>
					</li>
					<li class="nav-item">
						<a href="/c" class="nav-link">АКЦИИ</a>
					</li>
				</ul>
			</div>
		</section>

		<!-- Category Page -->
		<section class="category-page">
			<div class="container">
				<div class="category-header">
					<!-- Dropdown -->
					<div class="dropdown">
						<button class="dropdown-button" id="dropdownButton">
							Категория
							<img
								src="/assets/icons/arrowUp.svg"
								alt=""
								class="dropdown-arrow"
								id="dropdownArrow"
							/>
						</button>
						<ul class="dropdown-menu" id="dropdownMenu">
							<!-- Categories will be loaded here -->
							<li class="dropdown-item" data-category="Все">
								<div class="radio-indicator">
									<div class="radio-dot"></div>
								</div>
								<span>Все</span>
							</li>
							<li class="dropdown-item" data-category="Офис">
								<div class="radio-indicator">
									<div class="radio-dot"></div>
								</div>
								<span>Офис</span>
							</li>
							<li class="dropdown-item" data-category="Дом">
								<div class="radio-indicator">
									<div class="radio-dot"></div>
								</div>
								<span>Дом</span>
							</li>
							<li class="go-to-catalog" id="goToCatalog">Перейти в каталог</li>
						</ul>
					</div>

					<!-- Sort Dropdown -->
					<div class="sort-dropdown">
						<button class="sort-button" id="sortButton">
							Сортировать по: <span id="currentSort">Популярности</span>
							<svg
								class="sort-arrow"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									d="M19 9l-7 7-7-7"
								/>
							</svg>
						</button>
						<button class="mobile-catalog-button" id="mobileCatalogButton">
							Перейти в каталог
						</button>
						<ul class="sort-menu" id="sortMenu">
							<li class="sort-item" data-sort="Популярности">Популярности</li>
							<li class="sort-item" data-sort="По скидкам">По скидкам</li>
							<li class="sort-item" data-sort="Сначала дешевле">
								Сначала дешевле
							</li>
							<li class="sort-item" data-sort="Сначала дороже">
								Сначала дороже
							</li>
							<li class="sort-item" data-sort="По алфавиту">По алфавиту</li>
						</ul>
					</div>
				</div>

				<!-- Product Grid -->
				<div class="product-grid" id="productGrid">
					<!-- Product groups will be loaded here -->
					<div
						class="product-group"
						style="grid-template-columns: repeat(2, 1fr)"
					>
						<div class="product-item">
							<img
								src="https://images.unsplash.com/photo-1487017159836-4e23ece2e4cf?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8b2ZmaWNlfGVufDB8fDB8fHww"
								alt="Ночник LEGO"
								class="product-image"
							/>
							<p class="product-title">Ночник LEGO</p>
						</div>
						<div class="product-item">
							<img
								src="https://images.unsplash.com/photo-1517048676732-d65bc937f952?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8b2ZmaWNlfGVufDB8fDB8fHww"
								alt="Ночник LEGO"
								class="product-image"
							/>
							<p class="product-title">Ночник LEGO</p>
						</div>
					</div>
					<div
						class="product-group"
						style="grid-template-columns: repeat(3, 1fr)"
					>
						<div class="product-item">
							<img
								src="https://plus.unsplash.com/premium_photo-1683120730432-b5ea74bd9047?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8b2ZmaWNlfGVufDB8fDB8fHww"
								alt="Ночник LEGO"
								class="product-image"
							/>
							<p class="product-title">Ночник LEGO</p>
						</div>
						<div class="product-item">
							<img
								src="https://images.unsplash.com/photo-1431540015161-0bf868a2d407?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8b2ZmaWNlfGVufDB8fDB8fHww"
								alt="Ночник LEGO"
								class="product-image"
							/>
							<p class="product-title">Ночник LEGO</p>
						</div>
						<div class="product-item">
							<img
								src="https://images.unsplash.com/photo-1497215728101-856f4ea42174?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8b2ZmaWNlfGVufDB8fDB8fHww"
								alt="Ночник LEGO"
								class="product-image"
							/>
							<p class="product-title">Ночник LEGO</p>
						</div>
					</div>
					<!-- More product groups would be added here -->
				</div>

				<!-- Pagination -->
				<div class="pagination">
					<button class="page-button" id="prevPage" disabled>&lt;</button>
					<button class="page-button active">1</button>
					<button class="page-button">2</button>
					<button class="page-button">3</button>
					<button class="page-button">4</button>
					<button class="page-button" id="nextPage">&gt;</button>
				</div>
			</div>
		</section>
		<div id="footer"></div>
		<script src="layout-footer.js"></script>
		<script src="layout-header.js"></script>
		<script>
			// Dropdown functionality
			const dropdownButton = document.getElementById('dropdownButton')
			const dropdownArrow = document.getElementById('dropdownArrow')
			const dropdownMenu = document.getElementById('dropdownMenu')
			const dropdownItems = document.querySelectorAll('.dropdown-item')
			const goToCatalog = document.getElementById('goToCatalog')
			const mobileCatalogButton = document.getElementById('mobileCatalogButton')

			dropdownButton.addEventListener('click', () => {
				dropdownMenu.classList.toggle('open')
				dropdownArrow.classList.toggle('rotated')
			})

			dropdownItems.forEach((item) => {
				item.addEventListener('click', () => {
					const category = item.getAttribute('data-category')
					document
						.querySelector('.dropdown-item.active')
						?.classList.remove('active')
					item.classList.add('active')
					dropdownButton.textContent = category
					dropdownMenu.classList.remove('open')
					dropdownArrow.classList.remove('rotated')
					// Here you would typically filter products by category
				})
			})

			goToCatalog.addEventListener('click', () => {
				window.location.href = '/catalog'
			})

			mobileCatalogButton.addEventListener('click', () => {
				window.location.href = '/catalog'
			})

			// Sort dropdown functionality
			const sortButton = document.getElementById('sortButton')
			const sortArrow = document.querySelector('.sort-arrow')
			const sortMenu = document.getElementById('sortMenu')
			const sortItems = document.querySelectorAll('.sort-item')
			const currentSort = document.getElementById('currentSort')

			sortButton.addEventListener('click', () => {
				sortMenu.classList.toggle('open')
				sortArrow.classList.toggle('rotated')
			})

			sortItems.forEach((item) => {
				item.addEventListener('click', () => {
					const sortOption = item.getAttribute('data-sort')
					currentSort.textContent = sortOption
					sortMenu.classList.remove('open')
					sortArrow.classList.remove('rotated')
					// Here you would typically sort products
				})
			})

			// Pagination functionality
			const prevPage = document.getElementById('prevPage')
			const nextPage = document.getElementById('nextPage')
			const pageButtons = document.querySelectorAll(
				'.page-button:not(#prevPage):not(#nextPage)'
			)
			let activePage = 1
			const totalPages = 4

			function updatePagination() {
				pageButtons.forEach((button, index) => {
					if (index + 1 === activePage) {
						button.classList.add('active')
					} else {
						button.classList.remove('active')
					}
				})

				prevPage.disabled = activePage === 1
				nextPage.disabled = activePage === totalPages
			}

			pageButtons.forEach((button, index) => {
				button.addEventListener('click', () => {
					activePage = index + 1
					updatePagination()
					// Here you would typically load the new page of products
				})
			})

			prevPage.addEventListener('click', () => {
				if (activePage > 1) {
					activePage--
					updatePagination()
					// Here you would typically load the new page of products
				}
			})

			nextPage.addEventListener('click', () => {
				if (activePage < totalPages) {
					activePage++
					updatePagination()
					// Here you would typically load the new page of products
				}
			})

			// Close dropdowns when clicking outside
			document.addEventListener('click', (event) => {
				if (
					!dropdownButton.contains(event.target) &&
					!dropdownMenu.contains(event.target)
				) {
					dropdownMenu.classList.remove('open')
					dropdownArrow.classList.remove('rotated')
				}

				if (
					!sortButton.contains(event.target) &&
					!sortMenu.contains(event.target)
				) {
					sortMenu.classList.remove('open')
					sortArrow.classList.remove('rotated')
				}
			})

			// Set active nav link based on current URL
			const navLinks = document.querySelectorAll('.nav-link')
			const currentPath = window.location.pathname

			navLinks.forEach((link) => {
				if (link.getAttribute('href') === currentPath) {
					link.classList.add('active')
				}
			})

			// In a real app, you would fetch categories from an API
			// This is just a mock implementation
			async function fetchCategories() {
				// Simulate API call
				return new Promise((resolve) => {
					setTimeout(() => {
						resolve([
							{ id: 1, name: 'Все' },
							{ id: 2, name: 'Офис' },
							{ id: 3, name: 'Дом' },
							{ id: 4, name: 'Кухня' },
							{ id: 5, name: 'Детская' },
						])
					}, 500)
				})
			}

			// Load categories when page loads
			document.addEventListener('DOMContentLoaded', async () => {
				const categories = await fetchCategories()
				const dropdownMenu = document.getElementById('dropdownMenu')

				// Clear existing items except the "Go to catalog" button
				dropdownMenu.innerHTML = ''

				// Add categories to dropdown
				categories.forEach((category) => {
					const item = document.createElement('li')
					item.className = 'dropdown-item'
					item.setAttribute('data-category', category.name)

					item.innerHTML = `
                    <div class="radio-indicator">
                        <div class="radio-dot"></div>
                    </div>
                    <span>${category.name}</span>
                `

					item.addEventListener('click', () => {
						document
							.querySelector('.dropdown-item.active')
							?.classList.remove('active')
						item.classList.add('active')
						dropdownButton.textContent = category.name
						dropdownMenu.classList.remove('open')
						dropdownArrow.classList.remove('rotated')
					})

					dropdownMenu.appendChild(item)
				})

				// Add "Go to catalog" button back
				const catalogButton = document.createElement('li')
				catalogButton.className = 'go-to-catalog'
				catalogButton.textContent = 'Перейти в каталог'
				catalogButton.addEventListener('click', () => {
					window.location.href = '/catalog'
				})
				dropdownMenu.appendChild(catalogButton)

				// Set first category as active by default
				if (categories.length > 0) {
					dropdownMenu.querySelector('.dropdown-item').classList.add('active')
					dropdownButton.textContent = categories[0].name
				}
			})
		</script>
	</body>
</html>
